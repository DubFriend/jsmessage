/*  jsmessage
    github.com/DubFriend/jsmessage
    Brian Detering | BDeterin@gmail.com | BrianDetering.net
    28-07-2013 */
!function(){"use strict";var a={},b=Array.prototype,c=Object.prototype;Function.prototype;var d=(b.push,b.slice,b.concat,c.toString,c.hasOwnProperty),e=b.forEach,f=b.filter,g={};g.each=function(b,c,d){if(null!=b)if(e&&b.forEach===e)b.forEach(c,d);else if(b.length===+b.length){for(var f=0,h=b.length;h>f;f++)if(c.call(d,b[f],f,b)===a)return}else for(var i in b)if(g.has(b,i)&&c.call(d,b[i],i,b)===a)return},g.filter=function(a,b,c){var d=[];return null==a?d:f&&a.filter===f?a.filter(b,c):(g.each(a,function(a,e,f){b.call(c,a,e,f)&&d.push(a)}),d)},g.isFunction=function(a){return"function"==typeof a},g.has=function(a,b){return d.call(a,b)};var h={};if("undefined"!=typeof exports)"undefined"!=typeof module&&module.exports&&(exports=module.exports=h),exports.jsMessage=h;else{if(void 0!==this.jsMessage)throw"jsMessage is allready defined";this.jsMessage=h}h.mixinPubSub=function(a){a=a||{};var b={},c=[];return a.subscribe=function(a,d){a?(b[a]=b[a]||[],b[a].push(d)):c.push(d)},a.unsubscribe=function(a,d){var e=function(c){return g.filter(b[c],function(b){return b!==a})};if(d){if(!b[d])throw"topic not found";b[d]=e(d)}else g.each(b,function(a,c){b[c]=e(c)}),c=g.filter(c,function(b){return b!==a})},a.publish=function(a,d){a?g.each(b[a],function(a){a(d)}):g.each(b,function(a){g.each(a,function(a){a&&a(d)})}),g.each(c,function(a){a(d)})},a.autoPublish=function(a,b){var c,d=this;return function(e){var f;return void 0===e?c:(c=e,f=b?b(e):e,d.publish(a,f),void 0)}},a},h.mixinEvents=function(a,b){var c={},d=b||{};return g.each(a,function(b,e){g.isFunction(b)&&(a[e]=function(){var f,h=b.apply(a,arguments);return c[e]&&(d[e]&&(f=d[e].apply(a,[h])),g.each(c[e],function(a){a(f)})),h})}),a.on=function(a,b){c[a]=c[a]||[],c[a].push(b)},a.off=function(a,b){c[a]=b?g.filter(c[a],function(a){return a!==b}):void 0},a}}.call(this);